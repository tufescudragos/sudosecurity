<!DOCTYPE html>
<html>
  <head>
    <title>nmap live host discovery</title>
    <link rel="stylesheet" href="../css/style.css">
  </head>
  <body>
    <main>
      <h1>nmap live host discovery</h1>
      <p> nmap is an open source tool used for network mapping, live host discovery, port scanning and even operating system and service version detection. nmap is an enumeration tool. enumeration is the process of acquiring as much information 
        about the target and its network as possible. the more information we have, the easier it is to find vectors of attack.</p>
    </main>
    <section>
      <p> discovering live systems is essential. nmap's default behaviour is to first find the hosts, then scan their target's ports. we do not want to do the port-scanning now, because it generates too much noise and takes too much time. 
        <b>to disable port-scanning, we use <code>-sn</code></b>.</p>
      <p> also, by default, it uses reverse-DNS lookup on live hosts. this is beneficial as it can reveal a lot of information about the target, but it also is time consuming and less stealthy.
        <b>to disable reverse-DNS lookup, we use <code>-n</code>; to force it even on offline targets, we use <code>-R</code></b>.</p>
      <p> there are many ways to specify the targets:</p>
      <ul>
        <li>subnet: <code>192.168.1.0/24</code> will scan the whole subnet</li>
        <li>range: <code>192.168.1.0-4</code> will scan 5 IPs</li>
        <li>file: <code>-iL file.txt</code> will scan the list of IPs provided in the file(one ip on every row, no delimitator)</li>
        <li>list: <code>192.168.1.0, 192.168.1.64, 192.168.1.128</code> will scan the 3 IPs</li>
      </ul>
      <p> <b>to list all IPs that will be scanned, we use <code>-sL</code></b>.</p>
      <code><pre>[tufescu@laptopdragos ~]$ nmap -sL 192.168.1.0/30
Starting Nmap 7.97 ( https://nmap.org ) at 2025-09-06 02:11 +0300
Nmap scan report for 192.168.1.0
Nmap scan report for 192.168.1.1
Nmap scan report for 192.168.1.2
Nmap scan report for 192.168.1.3
Nmap done: 4 IP addresses (0 hosts up) scanned in 0.53 seconds</pre></code>
    </section>
    <section>
      <h3>host discovery using ARP</h3>
      <p> ARP scan is only possible if on the same subnet as the target. nmap sends an ARP query. a host that replies to the query is up. we expect to see many ARP queries when 
        scanning a network. <b>this scan can be triggered with <code>-PR</code></b>.</p>
      <img src="../../media/nmap/nmap_arp.png" height="200" alt="ARP illustration">     <br>      <br>
      <code><pre>[tufescu@laptopdragos ~]$ nmap -PR -sn 192.168.1.0/24
Starting Nmap 7.97 ( https://nmap.org ) at 2025-09-01 00:59 +0300
Nmap scan report for 192.168.1.1
Host is up (0.00041s latency).
MAC Address: ##:##:##:3C:69:50 (######## ################# Technologies)
Nmap scan report for 192.168.1.2
Host is up (0.10s latency).
MAC Address: ##:##:##:F4:B8:49 (Unknown)
Nmap scan report for 192.168.1.3
Host is up (0.10s latency).
MAC Address: ##:##:##:5D:45:4C (#### ######## Appliances, OF #####)
Nmap scan report for 192.168.1.5
Host is up (0.100s latency).
MAC Address: ##:##:##:1C:58:5C (Espressif)
Nmap scan report for 192.168.1.10
Host is up (0.11s latency).
MAC Address: ##:##:##:4F:16:87 (###### ########## San ve ###. A.S.)
Nmap scan report for 192.168.1.108
Host is up (0.12s latency).
MAC Address: ##:##:##:0A:26:7F (Unknown)
Nmap scan report for 192.168.1.11
Host is up.
Nmap scan report for 192.168.1.13
Host is up.
Nmap done: 256 IP addresses (8 hosts up) scanned in 5.02 seconds</pre></code>
      <p><code>#</code> represents redacted information</p>
    </section>
    <section>
      <h3>host discovery using ICMP</h3>
      <p> ICMP is often blocked by the firewall or other security measures. however, we can still try using the protocol in our scans.</p>
      <ul>
        <li><code>-PE</code> - uses ICMP echo requests(ICMP type 8)(same as ping) and listens for ICMP ping reply(ICMP type 0) - often times blocked, to be tried first</li>
        <li><code>-PP</code> - uses ICMP timestamp requests(ICMP type 13) and listens for ICMP timestamp reply(ICMP type 14) - stealthier, often not blocked, backup</li>
        <li><code>-PM</code> - uses ICMP address mask query(ICMP type 17) and listens for ICMP address mask reply(ICMP type 18) - often blocked, rarely used</li>
      </ul>
    </section>
    <section>
      <h3>host discovery using</h3>
      <h3>TCP</h3>
      <p> there are 2 types of scans with TCP packets. first one is the TCP SYN ping. when we send a SYN packet to a TCP port, it should replies with SYN/ACK if open and with 
        RST if closed. if, after sending a TCP packet on a TCP port, by default 80, we receive any response, it means that the host is up. <b>we can use TCP SYN ping with <code>-PS</code></b>.</p>
      <p> the second type of scan is TCP ACK ping. to use it we need to be privileged user. it works by sending an ACK packet to a TCP port, 80 by default. the port replies with 
        RST regardless of its state. if after sending the ACK packet we receive an RST response, it means that the host is up. <b>we can use TCP ACK ping with <code>-PA</code></b>.</p>
      <p> running <code>sudo nmap -PS(or -PA) -sn 192.168.1.0</code> returns similar output to the other scanning methods. security measures like firewalls can drop or reject 
        specific packet types and cause differences in responses with different techniques.</p>
      <img src="../../media/nmap/nmap_3wh.png" alt="3 way handshake illustration" height="190.5">     <br>
      <img src="../../media/nmap/nmap_PS.png" alt="-PS illustration" height="200">     <br>
      <img src="../../media/nmap/nmap_PA.png" alt="-PA illustration" height="200">     <br>
      <h3>UDP</h3>
      <p> sending a UDP packet to  an open port is not expected to lead to a reply, but sending to a closed port returns ICMP port unreachable reply. nmap sends UDP packets to
        high-number, most-likely closed ports and expects the ICMP reply. if it arrives, then the host is up.</p>
      <img src="../../media/nmap/nmap_PU1.png" alt="-PU illustration" height="200">     <br>
      <img src="../../media/nmap/nmap_PU2.png" alt="-PU illustration" height="200">
    </section>
    <section>
      <h3>Summary</h3>
      <ul>
        <li><code>-PR</code> - ARP scan</li>
        <li><code>-PE</code> - ICMP echo scan</li>
        <li><code>-PP</code> - ICMP timestamp scan</li>
        <li><code>-PM</code> - ICMP address mask scan</li>
        <li><code>-PS</code> - TCP SYN Ping scan</li>
        <li><code>-PA</code> - TCP ACK Ping scan</li>
        <li><code>-PU</code> - UDP Ping scan</li>
        <li><code>-n</code> - no DNS lookup</li>
        <li><code>-R</code> - reverse-DNS lookup for all hosts</li>
        <li><code>-sn</code> - host discovery only</li>
      </ul>
    </section>
    <br>
    <a href="../../index.html">go home</a>
  </body>
</html>